<% album_art = cached_image_url_to_base64(@album_art) if @album_art.present? %>
<% placeholder = vite_url_to_base64(vite_asset_url("images/lastfm-placeholder-3-sprite.webp")) %>

<defs>
  <style type="text/css"><![CDATA[
    <%= render partial: "music_np_banner/styles", formats: [:css] %>
    <%= render partial: "music_np_banner/fonts", formats: [:css] %>
  ]]></style>
  <pattern id="background" patternUnits="userSpaceOnUse" width="600" height="126" x="0" y="0">
    <image href="<%= vite_url_to_base64(vite_asset_url("images/lastfm.webp")) %>" x="0" y="0" width="600" height="126"></image>
  </pattern>
  <pattern id="album-cover" patternUnits="userSpaceOnUse" width="102" height="102" x="10" y="10" preserveAspectRatio="xMinYMin slice">
    <image href="<%= album_art.present? ? album_art : placeholder %>" width="<%= album_art.present? ? "102" : "" %>" height="<%= album_art.present? ? "102" : "" %>">
      <% if album_art.blank? %>
        <animate attributeType="XML" attributeName="x" values="0; -102; -204; -306; -408; -510; -612; -714; -816; -918; -1020; -1122" keyTimes="0; 0.1; 0.2; 0.3; 0.4; 0.5; 0.6; 0.65; 0.7; 0.8; 0.9; 1" dur="3.5s" begin="0s" calcMode="discrete" repeatCount="indefinite"/>
      <% end %>
    </image>
  </pattern>
  <pattern id="album-love" patternUnits="userSpaceOnUse" width="27" height="27" x="9" y="5">
    <image href="<%= vite_url_to_base64(vite_asset_url("images/heart.webp")) %>" width="27" height="27"></image>
  </pattern>
</defs>
<rect width="600" height="126" fill="url(#background)"></rect>
