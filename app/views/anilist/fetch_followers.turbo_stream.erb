<turbo-stream target="anilist" action="update">
  <template>
    <% if @error || !@success %>
      <%= render partial: "anilist/new", formats: [:html] %>

      <% if @error %>
        <script>
          Alpine.store("toasts").createToast("<%= sanitize @error %>", "error");
        </script>
      <% end %>
    <% else %>
      <div class="backdrop-blur-sm flex flex-col w-full h-screen px-4 py-4">
        <div class="dark:text-text--dark text-text--light max-w-sm mx-auto mb-6 font-sans text-3xl font-semibold text-center">
          <span class="opacity-80">Take me</span>
          <%= link_to "Back", anilist_index_path, class: "hover:text-[#3DB4F2] border-b", target: "anilist" %>
        </div>
        <div class="phone:flex-col phone:overflow-y-scroll laptop:flex-row phone:items-center laptop:items-start container relative flex justify-between gap-5 my-auto text-center">
          <div class="dark:bg-fg--dark bg-fg--light h-fit w-full max-w-sm border-b-4 border-blue-400 rounded-md">
            <div class="bg-inherit sticky top-0 px-10 pt-5 mb-5">
              <h1 class="border-b-text--light dark:border-b-text--dark dark:text-text--dark text-text--light text-2xl font-bold border-b-2">
                <%= sanitize "Not Following You (<span class='text-[#3DB4F2]'>#{(@following - @followers).size}</span>)" %>
              </h1>
            </div>
            <ul class="laptop:h-[70vh] laptop:overflow-y-scroll list-none mx-5">
              <% (@following - @followers).each do |f| %>
                <li class="hover:text-cyan-400 text-blue-400">
                  <%= link_to f, "https://anilist.co/user/#{f}", target: "_blank", rel: "noreferrer noopener" %>
                </li>
              <% end %>
            </ul>
          </div>

          <div class="dark:bg-fg--dark bg-fg--light h-fit w-full max-w-sm border-b-4 border-blue-400 rounded-md">
            <div class="bg-inherit sticky top-0 px-10 pt-5 mb-5">
              <h1 class="border-b-text--light dark:border-b-text--dark dark:text-text--dark text-text--light text-2xl font-bold border-b-2">
                <%= sanitize "You're Not Following (<span class='text-[#3DB4F2]'>#{(@followers - @following).size}</span>)" %>
              </h1>
            </div>
            <ul class="laptop:h-[70vh] laptop:overflow-y-scroll list-none mx-5">
              <% (@followers - @following).each do |f| %>
                <li class="hover:text-cyan-400 text-blue-400">
                  <%= link_to f, "https://anilist.co/user/#{f}", target: "_blank", rel: "noreferrer noopener" %>
                </li>
              <% end %>
            </ul>
          </div>

          <div class="dark:bg-fg--dark bg-fg--light h-fit w-full max-w-sm border-b-4 border-blue-400 rounded-md">
            <div class="bg-inherit sticky top-0 px-10 pt-5 mb-5">
              <h1 class="border-b-text--light dark:border-b-text--dark dark:text-text--dark text-text--light text-2xl font-bold border-b-2">
                <%= sanitize "Following (<span class='text-[#3DB4F2]'>#{@following_count}</span>)" %>
              </h1>
            </div>

            <ul class="laptop:h-[70vh] laptop:overflow-y-scroll list-none mx-5">
              <% @following.each do |f| %>
                <li class="hover:text-cyan-400 text-blue-400">
                  <%= link_to f, "https://anilist.co/user/#{f}", target: "_blank", rel: "noreferrer noopener" %>
                </li>
              <% end %>
            </ul>
          </div>

          <div class="dark:bg-fg--dark bg-fg--light h-fit w-full max-w-sm border-b-4 border-blue-400 rounded-md">
            <div class="bg-inherit sticky top-0 px-10 pt-5 mb-5">
              <h1 class="border-b-text--light dark:border-b-text--dark dark:text-text--dark text-text--light text-2xl font-bold border-b-2">
                <%= sanitize "Followers (<span class='text-[#3DB4F2]'>#{@followers_count}</span>)" %>
              </h1>
            </div>

            <ul class="laptop:h-[70vh] laptop:overflow-y-scroll list-none mx-5">
              <% @followers.each do |f| %>
                <li class="hover:text-cyan-400 text-blue-400">
                  <%= link_to f, "https://anilist.co/user/#{f}", target: "_blank", rel: "noreferrer noopener" %>
                </li>
              <% end %>
            </ul>
          </div>
        </div>
      </div>
    <% end %>
  </template>
</turbo-stream>
